

# Product Review Scraper

## Overview
This project consists of two main scripts: **`multi_product_url_scraper.py`** and **`product-review-scraper.py`**. Together, they allow users to efficiently scrape product information and reviews from a website.

## Scripts

### 1. Multi-Product URL Scraper (`multi_product_url_scraper.py`)

**Purpose:**  
This script scrapes product URLs, IDs, names, and prices from various product categories and saves this data into an Excel file. The scraped URLs can be used as input for the review scraping script.

**How It Works:**

1. **Initialize the Workbook:**  
   Creates a new Excel workbook to store scraped data.

2. **Define Product Categories:**  
   A dictionary is defined to map category names to their corresponding base URLs.

3. **Loop Through Categories:**  
   For each category, a new sheet is created in the Excel workbook, and headers for the data are added.

4. **Scrape Multiple Pages:**  
   The script iterates through multiple pages for each category:
   - **Set Up Chrome Options:** Random user-agent is assigned to simulate browser requests.
   - **Navigate to URL:** The script constructs the URL for the current page and navigates to it using Selenium.
   - **Wait for Page Load:** The script waits for a random interval to allow the page to load.

5. **Extract Product Data:**  
   The script locates product elements on the page and extracts:
   - **Product URL:** The direct link to the product.
   - **Product ID:** Extracted from the URL or the query parameters.
   - **Product Name:** The name of the product.
   - **Product Price:** The price of the product.
   Each product's data is appended to the corresponding category's Excel sheet.

6. **Error Handling:**  
   If an error occurs while scraping a page, it logs the error for debugging.

7. **Save the Data:**  
   Once all categories and pages have been processed, the workbook is saved to a specified file path.

### 2. Product Review Scraper (`product-review-scraper.py`)

**Purpose:**  
This script takes the Excel file generated by the `multi_product_url_scraper.py` as input, allowing it to scrape detailed reviews and other relevant information for each product.

**How It Works:**

1. **Load Input Excel File:**  
   The script loads the Excel file containing product URLs and IDs generated by the multi-product scraper.

2. **Define Data Models:**  
   Pydantic models are defined for structured parsing of JSON responses from the websiteâ€™s API.

3. **Loop Through Products:**  
   For each product, the script constructs API URLs to fetch reviews based on the product ID.

4. **Request Reviews:**  
   The script performs HTTP requests to gather reviews, utilizing retry logic to handle temporary issues or errors.

5. **Extract and Store Review Data:**  
   Reviews are parsed and stored in a structured format, with duplicates removed based on specific criteria (e.g., description and rating). The reviews are appended to an existing Excel sheet or a new sheet in the output workbook.

6. **Save the Final Output:**  
   Once all products have been processed, the final workbook containing product reviews is saved to a specified location.

## Installation

### Prerequisites
- Python 3.x
- Required libraries:
  - `curl_cffi`
  - `openpyxl`
  - `pydantic`
  - `selenium`

### Steps to Install
1. Clone the repository:
   ```bash
   git clone https://github.com/your-username/product-review-scraper.git
   ```
2. Change directory to the project folder:
   ```bash
   cd product-review-scraper
   ```
3. Install the required libraries:
   ```bash
   pip install -r requirements.txt
   ```

## Usage

1. Run `multi_product_url_scraper.py` to scrape product URLs and save them to an Excel file.
   ```bash
   python multi_product_url_scraper.py
   ```

2. Use the output Excel file from the previous step as input for `product-review-scraper.py` to scrape product reviews.
   ```bash
   python product-review-scraper.py
   ```

## License
This project is licensed under the MIT License.
```

### Notes:
- Update the placeholder `https://github.com/nirajmalviya/product-review-scraper.git` with the actual URL of your repository.
- You can adjust the installation steps or other sections based on your specific project setup or requirements.
